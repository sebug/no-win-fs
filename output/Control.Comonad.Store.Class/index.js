// Generated by psc-make version 0.6.8

/**
 *  | This module defines the `ComonadStore` type class and its instances.
 */
"use strict";
var Prelude = require("Prelude");
var Control_Extend = require("Control.Extend");
var Control_Comonad = require("Control.Comonad");
var Control_Comonad_Store_Trans = require("Control.Comonad.Store.Trans");
var Data_Tuple = require("Data.Tuple");

/**
 *  | The `ComonadStore` type class represents those monads which support local position information via
 *  | `pos` and `peek`.
 *  |
 *  | - `pos` reads the current position.
 *  | - `peek` reads the value at the specified position in the specified context.
 *  |
 *  | An implementation is provided for `StoreT`.
 *  |
 *  | Laws:
 *  |
 *  | - `pos (extend _ x) = pos x`
 *  | - `peek (pos x) x = extract x`
 *  |
 *  | For example:
 *  |
 *  | ```purescript
 *  | blur :: forall w. (ComonadStore Number w) -> w Number -> w Number
 *  | blur = extend \r -> (peeks (\n -> n - 1) r + peeks (\n -> n + 1) r) / 2)
 *  | ```
 */
var ComonadStore = function (__superclass_Control$dotComonad$dotComonad_0, peek, pos) {
    this["__superclass_Control.Comonad.Comonad_0"] = __superclass_Control$dotComonad$dotComonad_0;
    this.peek = peek;
    this.pos = pos;
};

/**
 *  | The `ComonadStore` type class represents those monads which support local position information via
 *  | `pos` and `peek`.
 *  |
 *  | - `pos` reads the current position.
 *  | - `peek` reads the value at the specified position in the specified context.
 *  |
 *  | An implementation is provided for `StoreT`.
 *  |
 *  | Laws:
 *  |
 *  | - `pos (extend _ x) = pos x`
 *  | - `peek (pos x) x = extract x`
 *  |
 *  | For example:
 *  |
 *  | ```purescript
 *  | blur :: forall w. (ComonadStore Number w) -> w Number -> w Number
 *  | blur = extend \r -> (peeks (\n -> n - 1) r + peeks (\n -> n + 1) r) / 2)
 *  | ```
 */
var pos = function (dict) {
    return dict.pos;
};

/**
 *  | The `ComonadStore` type class represents those monads which support local position information via
 *  | `pos` and `peek`.
 *  |
 *  | - `pos` reads the current position.
 *  | - `peek` reads the value at the specified position in the specified context.
 *  |
 *  | An implementation is provided for `StoreT`.
 *  |
 *  | Laws:
 *  |
 *  | - `pos (extend _ x) = pos x`
 *  | - `peek (pos x) x = extract x`
 *  |
 *  | For example:
 *  |
 *  | ```purescript
 *  | blur :: forall w. (ComonadStore Number w) -> w Number -> w Number
 *  | blur = extend \r -> (peeks (\n -> n - 1) r + peeks (\n -> n + 1) r) / 2)
 *  | ```
 */
var peek = function (dict) {
    return dict.peek;
};

/**
 *  | Extract a value from a position which depends on the current position.
 */
var peeks = function (__dict_ComonadStore_0) {
    return function (f) {
        return function (x) {
            return peek(__dict_ComonadStore_0)(f(pos(__dict_ComonadStore_0)(x)))(x);
        };
    };
};

/**
 *  | Reposition the focus at the specified position, which depends on the current position.
 */
var seeks = function (__dict_ComonadStore_1) {
    return function (__dict_Extend_2) {
        return function (f) {
            return function (x) {
                return peeks(__dict_ComonadStore_1)(f)(Control_Extend.duplicate(__dict_Extend_2)(x));
            };
        };
    };
};

/**
 *  | Reposition the focus at the specified position.
 */
var seek = function (__dict_ComonadStore_3) {
    return function (__dict_Extend_4) {
        return function (s) {
            return function (x) {
                return peek(__dict_ComonadStore_3)(s)(Control_Extend.duplicate(__dict_Extend_4)(x));
            };
        };
    };
};

/**
 *  | Extract a collection of values from positions which depend on the current position.
 */
var experiment = function (__dict_ComonadStore_5) {
    return function (__dict_Functor_6) {
        return function (f) {
            return function (x) {
                return Prelude["<$>"](__dict_Functor_6)(Prelude.flip(peek(__dict_ComonadStore_5))(x))(f(pos(__dict_ComonadStore_5)(x)));
            };
        };
    };
};
var comonadStoreStoreT = function (__dict_Comonad_7) {
    return new ComonadStore(function () {
        return Control_Comonad_Store_Trans.comonadStoreT(__dict_Comonad_7);
    }, function (_329) {
        return function (_330) {
            return Control_Comonad.extract(__dict_Comonad_7)(_330.value0)(_329);
        };
    }, function (_328) {
        return _328.value1;
    });
};
module.exports = {
    ComonadStore: ComonadStore, 
    seeks: seeks, 
    seek: seek, 
    peeks: peeks, 
    experiment: experiment, 
    peek: peek, 
    pos: pos, 
    comonadStoreStoreT: comonadStoreStoreT
};
