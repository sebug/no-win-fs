// Generated by psc-make version 0.6.8

/**
 *  | This module provides convenience functions for creating _breadcrumb_ navigation elements.
 */
"use strict";
var Halogen_HTML_Attributes = require("Halogen.HTML.Attributes");
var Halogen_HTML_Target = require("Halogen.HTML.Target");
var Halogen_HTML_Events = require("Halogen.HTML.Events");
var Control_Functor = require("Control.Functor");
var Halogen_HTML_Events_Handler = require("Halogen.HTML.Events.Handler");
var Halogen_HTML = require("Halogen.HTML");
var Halogen_Themes_Bootstrap3 = require("Halogen.Themes.Bootstrap3");
var Prelude = require("Prelude");
var Data_Array = require("Data.Array");
var Data_Tuple = require("Data.Tuple");

/**
 *  | A `CrumbTrail` is a zipper with a current location, and crumbs behind and in front of us.
 */
var CrumbTrail = (function () {
    function CrumbTrail(value0, value1, value2) {
        this.value0 = value0;
        this.value1 = value1;
        this.value2 = value2;
    };
    CrumbTrail.create = function (value0) {
        return function (value1) {
            return function (value2) {
                return new CrumbTrail(value0, value1, value2);
            };
        };
    };
    return CrumbTrail;
})();

/**
 *  | Create a breadcrumb navigation element from an array of `Crumb`s.
 */
var breadcrumbs = function (_2) {
    var fromCrumb = function (_3) {
        var attr = (function () {
            if (_3.value1 instanceof Halogen_HTML_Target.LinkTarget) {
                return [ Halogen_HTML_Attributes.href(Halogen_HTML_Target.runURL(_3.value1.value0)) ];
            };
            if (_3.value1 instanceof Halogen_HTML_Target.DataTarget) {
                return [ Halogen_HTML_Events.onClick(function (_1) {
                    return Control_Functor["$>"](Halogen_HTML_Events_Handler.functorEventHandler)(Halogen_HTML_Events_Handler.preventDefault)(_3.value1.value0);
                }) ];
            };
            throw new Error("Failed pattern match");
        })();
        return Halogen_HTML.li_([ Halogen_HTML.a(attr)([ Halogen_HTML.text(_3.value0) ]) ]);
    };
    return Halogen_HTML.ol([ Halogen_HTML_Attributes.class_(Halogen_Themes_Bootstrap3.breadcrumb) ])(Prelude["++"](Data_Array.semigroupArray)(Data_Array.map(fromCrumb)(_2.value0))(Prelude["++"](Data_Array.semigroupArray)([ Halogen_HTML.li([ Halogen_HTML_Attributes.class_(Halogen_Themes_Bootstrap3.active) ])([ Halogen_HTML.text(_2.value1) ]) ])(Data_Array.map(fromCrumb)(_2.value2))));
};
module.exports = {
    CrumbTrail: CrumbTrail, 
    breadcrumbs: breadcrumbs
};
